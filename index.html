<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>لوحة تحكم مراجعة حفظ القرآن</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f7f9fc; margin: 20px; direction: rtl; }
        h1 { text-align: center; color: #2c3e50; }
        .container { max-width: 1200px; margin: auto; }
        #levelStatsContainer { max-width: 600px; margin: 0 auto 30px auto; background: #fff; padding: 15px; border-radius: 10px; box-shadow: inset 0 0 10px #3498db; font-weight: bold; }
        .level-row { display: flex; align-items: center; justify-content: space-between; margin: 8px 0; }
        .level-label { min-width: 120px; text-align: right; color: #444; font-weight: bold; }
        .level-percentage { height: 25px; border-radius: 12px; background: #ddd; flex-grow: 1; margin: 0 10px; position: relative; }
        .level-fill { height: 100%; border-radius: 12px; color: white; font-weight: bold; text-align: right; padding-right: 10px; line-height: 25px; transition: width 0.5s ease; width: 0%; }
        .level-count { width: 130px; text-align: left; font-weight: normal; color: #222; }
        table { border-collapse: collapse; width: 100%; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 40px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        th { background-color: #3498db; color: white; }
        td[contenteditable="true"] { background-color: #ecf0f1; cursor: text; }
    </style>
</head>
<body>
    <div class="container">
        <h1>لوحة تحكم لمراجعة حفظ القرآن الكريم</h1>
        <div id="levelStatsContainer"></div>
        <table id="quranTable">
            <thead>
                <tr>
                  <th>رقم السورة</th>
                  <th>اسم السورة</th>
                  <th>مستوى الحفظ</th>
                  <th>تاريخ المراجعة 1</th>
                  <th>تاريخ المراجعة 2</th>
                  <th>تاريخ المراجعة 3</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <script>
      const surahs = [
          'الفاتحة', 'البقرة', 'آل عمران', 'النساء', 'المائدة', 'الأنعام', 'الأعراف', 'الأنفال', 'التوبة', 'يونس',
          'هود', 'يوسف', 'الرعد', 'إبراهيم', 'الحجر', 'النحل', 'الإسراء', 'الكهف', 'مريم', 'طه',
          'الأنبياء', 'الحج', 'المؤمنون', 'النور', 'الفرقان', 'الشعراء', 'النمل', 'القصص', 'العنكبوت', 'الروم',
          'لقمان', 'السجدة', 'الأحزاب', 'سبأ', 'فاطر', 'يس', 'الصافات', 'ص', 'الزمر', 'غافر',
          'فصلت', 'الشورى', 'الزخرف', 'الدخان', 'الجاثية', 'الأحقاف', 'محمد', 'الفتح', 'الحجرات', 'ق',
          'الذاريات', 'الطور', 'النجم', 'القمر', 'الرحمن', 'الواقعة', 'الحديد', 'المجادلة', 'الحشر', 'الممتحنة',
          'الصف', 'الجمعة', 'المنافقون', 'التغابن', 'الطلاق', 'التحريم', 'الملك', 'القلم', 'الحاقة', 'المعارج',
          'نوح', 'الجن', 'المزمل', 'المدثر', 'القيامة', 'الإنسان', 'المرسلات', 'النبأ', 'النازعات', 'عبس',
          'التكوير', 'الإنفطار', 'المطففين', 'الإنشقاق', 'البروج', 'الطارق', 'الأعلى', 'الغاشية', 'الفجر', 'البلد',
          'الشمس', 'الليل', 'الضحى', 'الشرح', 'التين', 'العلق', 'القدر', 'البينة', 'الزلزلة', 'العاديات',
          'القارعة', 'التكاثر', 'العصر', 'الهمزة', 'الفيل', 'قريش', 'الماعون', 'الكوثر', 'الكافرون', 'النصر',
          'المسد', 'الإخلاص', 'الفلق', 'الناس'
      ];

      const tbody = document.querySelector('#quranTable tbody');
      const levelStatsContainer = document.getElementById('levelStatsContainer');

      function loadSurahs() {
          surahs.forEach((surah, index) => {
              const tr = document.createElement('tr');
              const selectHtml = `<select id=\"level-${index}\">
                                    <option value=\"\">اختر المستوى</option>
                                    <option value=\"1\">ضعيف</option>
                                    <option value=\"2\">متوسط</option>
                                    <option value=\"3\">جيد</option>
                                    <option value=\"4\">ممتاز</option>
                                </select>`;
              tr.innerHTML = `
                  <td>${index + 1}</td>
                  <td>${surah}</td>
                  <td>${selectHtml}</td>
                  <td contenteditable=\"true\" id=\"review1-${index}\"></td>
                  <td contenteditable=\"true\" id=\"review2-${index}\"></td>
                  <td contenteditable=\"true\" id=\"review3-${index}\"></td>
              `;
              tbody.appendChild(tr);

              const select = tr.querySelector('select');
              select.addEventListener('change', () => {
                  updateLevelStats();
              });

              for(let i = 3; i <= 5; i++) {
                  const cell = tr.cells[i];
                  cell.addEventListener('input', () => {
                      updateLevelStats();
                  });
              }
          });
          updateLevelStats();
      }

      function updateLevelStats() {
          let counts = { '1': 0, '2': 0, '3': 0, '4': 0 };
          let total = 0;
          for(let row of tbody.children) {
              const select = row.querySelector('select');
              if(select && select.value && counts.hasOwnProperty(select.value)) {
                  counts[select.value]++;
                  total++;
              }
          }
          if(total === 0) {
              levelStatsContainer.innerHTML = '<em>لم يتم تعيين مستويات الحفظ بعد.</em>';
              return;
          }
          const levelColors = { '1': '#e74c3c', '2': '#f39c12', '3': '#2980b9', '4': '#27ae60' };
          const levelNames = { '1': 'ضعيف', '2': 'متوسط', '3': 'جيد', '4': 'ممتاز' };
          let html = '';
          for(let level of ['1', '2', '3', '4']) {
              const percent = ((counts[level] / total) * 100).toFixed(1);
              const countText = counts[level] === 1 ? `1 سورة` : `${counts[level]} سور`;
              html += `<div class=\"level-row\">
                  <span class=\"level-label\">${levelNames[level]}</span>
                  <div class=\"level-percentage\">
                      <div class=\"level-fill\" style=\"background-color: ${levelColors[level]}; width: ${percent}%;\">${percent}%</div>
                  </div>
                  <span class=\"level-count\">${countText}</span>
              </div>`;
          }
          levelStatsContainer.innerHTML = html;
      }

      window.onload = loadSurahs;
    </script>
</body>
</html>
